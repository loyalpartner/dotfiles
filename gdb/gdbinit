#
# manual:
#   https://sourceware.org/gdb/current/onlinedocs/gdb/index.html
#
python
from os.path import exists, expandvars

# init_config=expandvars('$HOME/dotfiles/gdb/init.py')
gdb.execute('source %s' % expandvars('$HOME/.config/gdb/stl_pretty'))

end


set debuginfod enabled off
skip -rfu '^(absl|std)(::[a-zA-z0-9_]+)+<.*>.+'
skip -rfu '([a-zA-z0-9_]+)::\1'
skip -gfi 'base/allocator/*.h'

set pagination off
set history save yes
set history size 10000
set history remove-duplicates unlimited

set print object on
set print pretty on

# set auto-load python-scripts on
# set auto-load safe-path ~/company/gdb-scripts/debug-protobuf.py
# add-auto-load-safe-path /home/lee/company/gdb-scripts/debug-protobuf.py
# add-auto-load-scripts-directory /home/lee/company/gdb-scripts


source ~/dotfiles/gdb/break_history

# Print a C++ string.
define ps
  print $arg0.c_str()
end

# Print a C++ wstring or wchar_t*.
define pws
  printf "\""
  set $c = (wchar_t*)$arg0
  while ( *$c )
    if ( *$c > 0x7f )
      printf "[%x]", *$c
    else
      printf "%c", *$c
    end
    set $c++
  end
  printf "\"\n"
end

# set substitute-path /proc/self/cwd/ /home/lee/Documents/protols/server/addon/protobuf/

